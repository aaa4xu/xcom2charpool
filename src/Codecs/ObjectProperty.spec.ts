import { ArrayBufferReader } from '../ArrayBuffer/ArrayBufferReader';
import { CodecRegistry } from '../Registry';
import { ObjectProperty } from './ObjectProperty';
import { CodecContext } from '../CodecContext';
import { ArrayBufferWriter } from '../ArrayBuffer/ArrayBufferWriter';
import { BytePropertyValue } from '../Values/BytePropertyValue';
import { StructPropertyValue } from '../Values/StructPropertyValue';
import { RawArrayValue } from '../Values/RawArrayValue';
import { IntArrayElement } from './IntArrayElement';
import { ByteArrayElement } from './ByteArrayElement';

describe('ObjectProperty', () => {
    test.each([
        [
            'IntProperty',
            [
                0x09, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x49, 0x6e, 0x74, 0x31, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x0c, 0x00, 0x00, 0x00, 0x49, 0x6e, 0x74, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x09, 0x00,
                0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x49, 0x6e, 0x74, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00,
                0x00, 0x00, 0x49, 0x6e, 0x74, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00,
                0x74, 0x65, 0x73, 0x74, 0x49, 0x6e, 0x74, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00,
                0x49, 0x6e, 0x74, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4e, 0x6f,
                0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00,
            ],
            {
                testInt1: 1,
                testInt2: 1,
                testInt3: 1,
            },
        ],
        [
            'BoolProperty',
            [
                0x0a, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x42, 0x6f, 0x6f, 0x6c, 0x31, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x0d, 0x00, 0x00, 0x00, 0x42, 0x6f, 0x6f, 0x6c, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x0a, 0x00, 0x00,
                0x00, 0x74, 0x65, 0x73, 0x74, 0x42, 0x6f, 0x6f, 0x6c, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0d, 0x00,
                0x00, 0x00, 0x42, 0x6f, 0x6f, 0x6c, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x05, 0x00, 0x00, 0x00, 0x4e, 0x6f,
                0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00,
            ],
            {
                testBool1: true,
                testBool3: true,
            },
        ],
        [
            'ByteProperty',
            [
                0x06, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x31, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0d, 0x00, 0x00,
                0x00, 0x42, 0x79, 0x74, 0x65, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x13, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x45, 0x55, 0x6e, 0x69,
                0x66, 0x6f, 0x72, 0x6d, 0x53, 0x74, 0x61, 0x74, 0x75, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00,
                0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x4d, 0x61, 0x6e, 0x75, 0x61, 0x6c, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x06, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0d, 0x00, 0x00,
                0x00, 0x42, 0x79, 0x74, 0x65, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x15, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x45, 0x55, 0x6e, 0x69,
                0x66, 0x6f, 0x72, 0x6d, 0x53, 0x74, 0x61, 0x74, 0x75, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0d, 0x00,
                0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x41, 0x6e, 0x79, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0d,
                0x00, 0x00, 0x00, 0x42, 0x79, 0x74, 0x65, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x1a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x45, 0x55,
                0x6e, 0x69, 0x66, 0x6f, 0x72, 0x6d, 0x53, 0x74, 0x61, 0x74, 0x75, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65, 0x63,
                0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x65,
                0x00, 0x00, 0x00, 0x00, 0x00,
            ],
            {
                test1: new BytePropertyValue('EUniformStatus', 'EUS_Manual'),
                test2: new BytePropertyValue('EUniformStatus', 'EUS_AnyClass'),
                test3: new BytePropertyValue('EUniformStatus', 'EUS_ClassSpecific'),
            },
        ],
        [
            'StrProperty',
            [
                0x0d, 0x00, 0x00, 0x00, 0x73, 0x74, 0x72, 0x46, 0x69, 0x72, 0x73, 0x74, 0x4e, 0x61, 0x6d, 0x65, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x53, 0x74, 0x72, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72,
                0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff,
                0xff, 0xff, 0x57, 0x00, 0x42, 0x04, 0x35, 0x04, 0x41, 0x04, 0x42, 0x04, 0x4b, 0x04, 0x57, 0x00, 0x00,
                0x00, 0x0c, 0x00, 0x00, 0x00, 0x73, 0x74, 0x72, 0x4c, 0x61, 0x73, 0x74, 0x4e, 0x61, 0x6d, 0x65, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x53, 0x74, 0x72, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72,
                0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf9, 0xff,
                0xff, 0xff, 0x57, 0x00, 0x42, 0x04, 0x35, 0x04, 0x41, 0x04, 0x42, 0x04, 0x57, 0x00, 0x00, 0x00, 0x05,
                0x00, 0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00,
            ],

            {
                strFirstName: 'WтестыW',
                strLastName: 'WтестW',
            },
        ],
        [
            'StructProperty',
            [
                0x06, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x31, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00,
                0x00, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x54, 0x65,
                0x73, 0x74, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
                0x54, 0x65, 0x73, 0x74, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x56, 0x61, 0x6c, 0x75, 0x65, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x53, 0x74, 0x72, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74,
                0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00,
                0x00, 0x76, 0x61, 0x6c, 0x75, 0x65, 0x31, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x65, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x32, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x0f, 0x00, 0x00, 0x00, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72,
                0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00,
                0x00, 0x00, 0x54, 0x65, 0x73, 0x74, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x10, 0x00, 0x00, 0x00, 0x54, 0x65, 0x73, 0x74, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x56, 0x61, 0x6c,
                0x75, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x53, 0x74, 0x72, 0x50, 0x72, 0x6f,
                0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x07, 0x00, 0x00, 0x00, 0x76, 0x61, 0x6c, 0x75, 0x65, 0x32, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4e,
                0x6f, 0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x33,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x50, 0x72,
                0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x54, 0x65, 0x73, 0x74, 0x53, 0x74, 0x72, 0x75, 0x63, 0x74, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x54, 0x65, 0x73, 0x74, 0x53, 0x74, 0x72, 0x75, 0x63,
                0x74, 0x56, 0x61, 0x6c, 0x75, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x53, 0x74,
                0x72, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x76, 0x61, 0x6c, 0x75, 0x65, 0x33, 0x00, 0x05,
                0x00, 0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4e,
                0x6f, 0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00,
            ],

            {
                test1: new StructPropertyValue(
                    'TestStruct',
                    new Map(
                        Object.entries({
                            TestStructValue: 'value1',
                        }),
                    ),
                ),
                test2: new StructPropertyValue(
                    'TestStruct',
                    new Map(
                        Object.entries({
                            TestStructValue: 'value2',
                        }),
                    ),
                ),
                test3: new StructPropertyValue(
                    'TestStruct',
                    new Map(
                        Object.entries({
                            TestStructValue: 'value3',
                        }),
                    ),
                ),
            },
        ],
        [
            'ArrayProperty[IntProperty]',
            [
                0x0c, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x31, 0x69, 0x6e, 0x74, 0x61, 0x72, 0x72, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x41, 0x72, 0x72, 0x61, 0x79, 0x50, 0x72, 0x6f, 0x70, 0x65,
                0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09,
                0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00,
                0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00,
                0x00, 0x03, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x32, 0x69, 0x6e, 0x74,
                0x61, 0x72, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x41, 0x72, 0x72, 0x61, 0x79,
                0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x04,
                0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x33, 0x69, 0x6e, 0x74, 0x61, 0x72,
                0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x41, 0x72, 0x72, 0x61, 0x79, 0x50, 0x72,
                0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00,
                0x00, 0x06, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00,
                0x4e, 0x6f, 0x6e, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00,
            ],
            {
                test1intarr: [1, 2, 3, 1, 2, 3, 1, 2, 3],
                test2intarr: new RawArrayValue(
                    3,
                    new Uint8Array([0x04, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00]),
                ),
                test3intarr: [5, 6, 5, 6, 5, 6],
            },
        ],
        [
            'ArrayProperty[ByteProperty]',
            [
                0x0a, 0x00, 0x00, 0x00, 0x74, 0x65, 0x73, 0x74, 0x32, 0x62, 0x61, 0x72, 0x72, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x0e, 0x00, 0x00, 0x00, 0x41, 0x72, 0x72, 0x61, 0x79, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74,
                0x79, 0x00, 0x00, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00,
                0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65,
                0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53,
                0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70,
                0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x74, 0x65,
                0x73, 0x74, 0x33, 0x62, 0x61, 0x72, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x41,
                0x72, 0x72, 0x61, 0x79, 0x50, 0x72, 0x6f, 0x70, 0x65, 0x72, 0x74, 0x79, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x97, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45,
                0x55, 0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x4e, 0x6f, 0x6e, 0x53, 0x6f,
                0x6c, 0x64, 0x69, 0x65, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53,
                0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x4e, 0x6f, 0x6e, 0x53, 0x6f, 0x6c, 0x64,
                0x69, 0x65, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x43,
                0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x0f, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x4e, 0x6f, 0x6e, 0x53, 0x6f, 0x6c, 0x64, 0x69, 0x65,
                0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x65, 0x00, 0x00, 0x00,
                0x00, 0x00,
            ],
            {
                test2barr: new RawArrayValue(
                    3,
                    new Uint8Array([
                        0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65,
                        0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55,
                        0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73, 0x73, 0x53, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00,
                        0x00, 0x00, 0x00, 0x00, 0x12, 0x00, 0x00, 0x00, 0x45, 0x55, 0x53, 0x5f, 0x43, 0x6c, 0x61, 0x73,
                        0x73, 0x53, 0x70, 0x65, 0x63, 0x69, 0x66, 0x69, 0x63, 0x00, 0x00, 0x00, 0x00, 0x00,
                    ]),
                ),
                test3barr: [
                    new BytePropertyValue('EUniformStatus', 'EUS_ClassSpecific'),
                    new BytePropertyValue('EUniformStatus', 'EUS_NonSoldier'),
                    new BytePropertyValue('EUniformStatus', 'EUS_ClassSpecific'),
                    new BytePropertyValue('EUniformStatus', 'EUS_NonSoldier'),
                    new BytePropertyValue('EUniformStatus', 'EUS_ClassSpecific'),
                    new BytePropertyValue('EUniformStatus', 'EUS_NonSoldier'),
                ],
            },
        ],
    ])('round-trips %s', (_, raw, expected) => {
        const bytes = new Uint8Array(raw);

        const registry = new CodecRegistry();
        registry.registerArray('test1intarr', new IntArrayElement());
        registry.registerArray('test3intarr', new IntArrayElement());
        registry.registerArray('test3barr', new ByteArrayElement('EUniformStatus'));

        const reader = new ArrayBufferReader(new DataView(bytes.buffer));
        const writer = new ArrayBufferWriter();
        const object = new ObjectProperty();

        const ctx: CodecContext = {
            registry,
            path: ['<root>'],
        };

        const data = object.read(reader, 0, ctx);
        expect(data).toStrictEqual(new Map(Object.entries(expected)));

        object.write(writer, data, ctx);
        // console.log('data', data);

        expect(new Uint8Array(writer.getBuffer())).toStrictEqual(bytes);
    });
});
